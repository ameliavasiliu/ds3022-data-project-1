2025-09-28 18:33:40,006 - INFO - Connected to DuckDB successfully
2025-09-28 18:33:40,006 - INFO - Querying largest CO2-producing trip for each taxi type.
2025-09-28 18:33:40,007 - ERROR - An error occurred: Parser Error: syntax error at or near "UNION"

LINE 4:         UNION ALL
                ^
2025-09-28 18:45:44,861 - INFO - Connected to DuckDB successfully
2025-09-28 18:45:44,862 - INFO - Querying largest CO2-producing trip for yellow taxi.
2025-09-28 18:45:46,368 - INFO - Querying largest CO2-producing trip for green taxi.
2025-09-28 18:45:46,466 - ERROR - An error occurred: 'DataFrame' object has no attribute 'append'
2025-09-28 18:47:37,641 - INFO - Connected to DuckDB successfully
2025-09-28 18:47:37,641 - INFO - Querying largest CO2-producing trip for yellow taxi.
2025-09-28 18:47:38,954 - INFO - Querying largest CO2-producing trip for green taxi.
2025-09-28 18:47:39,044 - ERROR - An error occurred: cannot access local variable 'pd' where it is not associated with a value
2025-09-28 18:51:45,049 - INFO - Connected to DuckDB successfully
2025-09-28 18:51:45,049 - INFO - Querying largest CO2-producing trip for yellow taxi.
2025-09-28 18:51:46,278 - INFO - Querying largest CO2-producing trip for green taxi.
2025-09-28 18:51:46,357 - ERROR - An error occurred: cannot access local variable 'pd' where it is not associated with a value
2025-09-28 18:52:20,710 - INFO - Connected to DuckDB successfully
2025-09-28 18:52:20,710 - INFO - Querying largest CO2-producing trip for yellow taxi.
2025-09-28 18:52:21,880 - INFO - Querying largest CO2-producing trip for green taxi.
2025-09-28 18:52:21,969 - ERROR - An error occurred: cannot access local variable 'pd' where it is not associated with a value
2025-09-28 18:53:42,619 - INFO - Connected to DuckDB successfully
2025-09-28 18:53:42,619 - INFO - Querying largest CO2-producing trip for yellow taxi.
2025-09-28 18:53:43,798 - INFO - Querying largest CO2-producing trip for green taxi.
2025-09-28 18:53:43,880 - ERROR - An error occurred: cannot access local variable 'pd' where it is not associated with a value
2025-09-28 18:56:07,367 - INFO - Connected to DuckDB successfully
2025-09-28 18:56:07,367 - INFO - Querying largest CO2-producing trip for yellow taxi.
2025-09-28 18:56:08,227 - INFO - Querying largest CO2-producing trip for green taxi.
2025-09-28 18:56:08,314 - INFO - Largest CO2 trips:
  taxi_type tpep_pickup_datetime  ... lpep_pickup_datetime  lpep_dropoff_datetime
0    yellow  2016-02-17 23:58:41  ...                  NaT                    NaT
1     green                  NaT  ...  2015-07-14 14:20:32    2015-07-14 16:39:22

[2 rows x 13 columns]
2025-09-28 18:56:08,314 - INFO - Querying CO2 by hour of day.
2025-09-28 18:56:08,314 - INFO - Querying CO2 by hour_of_day (yellow) for yellow_transform.
2025-09-28 18:56:09,061 - INFO - Querying CO2 by hour_of_day (green) for green_transform.
2025-09-28 18:56:09,134 - INFO - Yellow taxi - Heaviest hour: {'hour_of_day': 5.0, 'avg_co2': 1.8477767249994947}, Lightest hour: {'hour_of_day': 9.0, 'avg_co2': 1.021739794009095}
2025-09-28 18:56:09,134 - INFO - Green taxi - Heaviest hour: {'hour_of_day': 5.0, 'avg_co2': 1.5416361099180993}, Lightest hour: {'hour_of_day': 18.0, 'avg_co2': 0.8977014494681611}
2025-09-28 18:56:09,134 - INFO - Querying CO2 by day of week.
2025-09-28 18:56:09,134 - INFO - Querying CO2 by day_of_week (yellow) for yellow_transform.
2025-09-28 18:56:09,712 - INFO - Querying CO2 by day_of_week (green) for green_transform.
2025-09-28 18:56:09,761 - INFO - Yellow taxi - Heaviest day: {'day_of_week': 'Sunday', 'avg_co2': 1.2757421431524458}, Lightest day: {'day_of_week': 'Saturday', 'avg_co2': 1.1131573320902517}
2025-09-28 18:56:09,761 - INFO - Green taxi - Heaviest day: {'day_of_week': 'Sunday', 'avg_co2': 1.0803910482675856}, Lightest day: {'day_of_week': 'Tuesday', 'avg_co2': 1.0025629461115955}
2025-09-28 18:56:09,761 - INFO - Querying CO2 by week of year.
2025-09-28 18:56:09,761 - INFO - Querying CO2 by week_of_year (yellow) for yellow_transform.
2025-09-28 18:56:10,562 - INFO - Querying CO2 by week_of_year (green) for green_transform.
2025-09-28 18:56:10,619 - INFO - Yellow taxi - Heaviest week: {'week_of_year': 35.0, 'avg_co2': 1.235483490114251}, Lightest week: {'week_of_year': 5.0, 'avg_co2': 1.0614581105140926}
2025-09-28 18:56:10,619 - INFO - Green taxi - Heaviest week: {'week_of_year': 35.0, 'avg_co2': 1.1034715892017386}, Lightest week: {'week_of_year': 5.0, 'avg_co2': 0.978542641308405}
2025-09-28 18:56:10,619 - INFO - Querying CO2 by month_of_year (yellow) for yellow_transform.
2025-09-28 18:56:11,155 - INFO - Querying CO2 by month_of_year (green) for green_transform.
2025-09-28 18:56:11,201 - INFO - Yellow taxi - Heaviest month: {'month_of_year': 'August', 'avg_co2': 1.208030987448133}, Lightest month: {'month_of_year': 'February', 'avg_co2': 1.0943823694102304}
2025-09-28 18:56:11,201 - INFO - Green taxi - Heaviest month: {'month_of_year': 'August', 'avg_co2': 1.0641002001619793}, Lightest month: {'month_of_year': 'January', 'avg_co2': 0.9881701860928359}
2025-09-28 18:56:11,201 - INFO - Generating CO2 by month plot.
2025-09-28 18:56:12,538 - INFO - Plot saved as co2_by_month.png
2025-09-28 20:30:13,783 - INFO - Connected to DuckDB successfully
2025-09-28 20:30:13,784 - INFO - Querying largest CO2-producing trip for yellow taxi.
2025-09-28 20:30:15,268 - INFO - Querying largest CO2-producing trip for green taxi.
2025-09-28 20:30:15,379 - INFO - Largest CO2 trips:
  taxi_type tpep_pickup_datetime tpep_dropoff_datetime  passenger_count  ...  week_of_year  month_of_year  lpep_pickup_datetime  lpep_dropoff_datetime
0    yellow  2016-02-17 23:58:41   2016-02-18 00:14:01                1  ...             7       February                   NaT                    NaT
1     green                  NaT                   NaT                6  ...            29           July   2015-07-14 14:20:32    2015-07-14 16:39:22

[2 rows x 13 columns]
2025-09-28 20:30:15,379 - INFO - Querying CO2 by hour of day.
2025-09-28 20:30:15,379 - INFO - Querying CO2 by hour_of_day (yellow) for yellow_transform.
2025-09-28 20:30:16,324 - INFO - Querying CO2 by hour_of_day (green) for green_transform.
2025-09-28 20:30:16,396 - INFO - Yellow taxi - Heaviest hour: {'hour_of_day': 5.0, 'avg_co2': 1.8477767249995027}, Lightest hour: {'hour_of_day': 9.0, 'avg_co2': 1.0217397940090964}
2025-09-28 20:30:16,396 - INFO - Green taxi - Heaviest hour: {'hour_of_day': 5.0, 'avg_co2': 1.5416361099180982}, Lightest hour: {'hour_of_day': 18.0, 'avg_co2': 0.89770144946816}
2025-09-28 20:30:16,396 - INFO - Querying CO2 by day of week.
2025-09-28 20:30:16,396 - INFO - Querying CO2 by day_of_week (yellow) for yellow_transform.
2025-09-28 20:30:17,000 - INFO - Querying CO2 by day_of_week (green) for green_transform.
2025-09-28 20:30:17,052 - INFO - Yellow taxi - Heaviest day: {'day_of_week': 'Sunday', 'avg_co2': 1.2757421431524403}, Lightest day: {'day_of_week': 'Saturday', 'avg_co2': 1.1131573320902532}
2025-09-28 20:30:17,052 - INFO - Green taxi - Heaviest day: {'day_of_week': 'Sunday', 'avg_co2': 1.0803910482675818}, Lightest day: {'day_of_week': 'Tuesday', 'avg_co2': 1.0025629461115981}
2025-09-28 20:30:17,052 - INFO - Querying CO2 by week of year.
2025-09-28 20:30:17,052 - INFO - Querying CO2 by week_of_year (yellow) for yellow_transform.
2025-09-28 20:30:17,694 - INFO - Querying CO2 by week_of_year (green) for green_transform.
2025-09-28 20:30:17,751 - INFO - Yellow taxi - Heaviest week: {'week_of_year': 35.0, 'avg_co2': 1.2354834901142455}, Lightest week: {'week_of_year': 5.0, 'avg_co2': 1.0614581105140937}
2025-09-28 20:30:17,751 - INFO - Green taxi - Heaviest week: {'week_of_year': 35.0, 'avg_co2': 1.1034715892017402}, Lightest week: {'week_of_year': 5.0, 'avg_co2': 0.9785426413084055}
2025-09-28 20:30:17,751 - INFO - Querying CO2 by month_of_year (yellow) for yellow_transform.
2025-09-28 20:30:18,341 - INFO - Querying CO2 by month_of_year (green) for green_transform.
2025-09-28 20:30:18,395 - INFO - Yellow taxi - Heaviest month: {'month_of_year': 'August', 'avg_co2': 1.2080309874481368}, Lightest month: {'month_of_year': 'February', 'avg_co2': 1.0943823694102242}
2025-09-28 20:30:18,395 - INFO - Green taxi - Heaviest month: {'month_of_year': 'August', 'avg_co2': 1.0641002001619733}, Lightest month: {'month_of_year': 'January', 'avg_co2': 0.9881701860928283}
2025-09-28 20:30:18,395 - INFO - Generating CO2 by month plot.
2025-09-28 20:30:19,187 - INFO - Plot saved as co2_by_month.png
2025-09-28 20:46:06,824 - INFO - Connected to DuckDB successfully
2025-09-28 20:46:06,824 - INFO - Querying largest CO2-producing trip for yellow taxi.
2025-09-28 20:46:07,899 - INFO - Querying largest CO2-producing trip for green taxi.
2025-09-28 20:46:07,998 - INFO - Largest CO2 trips:
  taxi_type tpep_pickup_datetime tpep_dropoff_datetime  passenger_count  ...  week_of_year  month_of_year  lpep_pickup_datetime  lpep_dropoff_datetime
0    yellow  2016-02-17 23:58:41   2016-02-18 00:14:01                1  ...             7       February                   NaT                    NaT
1     green                  NaT                   NaT                6  ...            29           July   2015-07-14 14:20:32    2015-07-14 16:39:22

[2 rows x 13 columns]
2025-09-28 20:46:07,998 - INFO - Querying CO2 by hour of day.
2025-09-28 20:46:07,998 - INFO - Querying CO2 by hour_of_day (yellow) for yellow_transform.
2025-09-28 20:46:08,781 - INFO - Querying CO2 by hour_of_day (green) for green_transform.
2025-09-28 20:46:08,850 - INFO - Yellow taxi - Heaviest hour: {'hour_of_day': 5.0, 'avg_co2': 1.847776724999498}, Lightest hour: {'hour_of_day': 9.0, 'avg_co2': 1.0217397940090946}
2025-09-28 20:46:08,850 - INFO - Green taxi - Heaviest hour: {'hour_of_day': 5.0, 'avg_co2': 1.5416361099180989}, Lightest hour: {'hour_of_day': 18.0, 'avg_co2': 0.897701449468159}
2025-09-28 20:46:08,850 - INFO - Querying CO2 by day of week.
2025-09-28 20:46:08,850 - INFO - Querying CO2 by day_of_week (yellow) for yellow_transform.
2025-09-28 20:46:09,443 - INFO - Querying CO2 by day_of_week (green) for green_transform.
2025-09-28 20:46:09,495 - INFO - Yellow taxi - Heaviest day: {'day_of_week': 'Sunday', 'avg_co2': 1.2757421431524445}, Lightest day: {'day_of_week': 'Saturday', 'avg_co2': 1.1131573320902388}
2025-09-28 20:46:09,495 - INFO - Green taxi - Heaviest day: {'day_of_week': 'Sunday', 'avg_co2': 1.0803910482675825}, Lightest day: {'day_of_week': 'Tuesday', 'avg_co2': 1.002562946111596}
2025-09-28 20:46:09,495 - INFO - Querying CO2 by week of year.
2025-09-28 20:46:09,495 - INFO - Querying CO2 by week_of_year (yellow) for yellow_transform.
2025-09-28 20:46:10,069 - INFO - Querying CO2 by week_of_year (green) for green_transform.
2025-09-28 20:46:10,169 - INFO - Yellow taxi - Heaviest week: {'week_of_year': 35.0, 'avg_co2': 1.2354834901142484}, Lightest week: {'week_of_year': 5.0, 'avg_co2': 1.0614581105140877}
2025-09-28 20:46:10,169 - INFO - Green taxi - Heaviest week: {'week_of_year': 35.0, 'avg_co2': 1.1034715892017368}, Lightest week: {'week_of_year': 5.0, 'avg_co2': 0.9785426413084065}
2025-09-28 20:46:10,169 - INFO - Querying CO2 by month_of_year (yellow) for yellow_transform.
2025-09-28 20:46:10,853 - INFO - Querying CO2 by month_of_year (green) for green_transform.
2025-09-28 20:46:10,901 - INFO - Yellow taxi - Heaviest month: {'month_of_year': 'August', 'avg_co2': 1.2080309874481412}, Lightest month: {'month_of_year': 'February', 'avg_co2': 1.0943823694102326}
2025-09-28 20:46:10,902 - INFO - Green taxi - Heaviest month: {'month_of_year': 'August', 'avg_co2': 1.064100200161963}, Lightest month: {'month_of_year': 'January', 'avg_co2': 0.9881701860928356}
2025-09-28 20:46:10,902 - INFO - Generating CO2 by month plot.
2025-09-28 20:46:11,695 - INFO - Plot saved as co2_by_month.png
